[[search-aggregations-bucket]]
== 分桶聚合（Bucket Aggregations）

分桶聚合不向指标聚合那样计算字段的指标，相反地，它会创造一些文档的 bucket。每个 bucket 会与一个规则（取决于聚合的类型）相关联，这个规则确定了当前上下文中的是否“落入”这个 bucket。另一方面，这些 bucket 有效的定义了文档集。除了 bucket 本身之外， `bucket` 聚合还可以计算并返回落入每个 bucket 中的文档的数量。

分桶聚合与指标聚合还有一个不同点，就是它可以有子聚合。这些子聚合可以对父聚合产生的 bucket 进行聚合。

ElasticSearch 中有各种各样的分桶聚合器，每一种都有自己独特的“划分”的策略。其中一些定义了一个 bucket，还有一些定义了固定数量 bucket，而另一些则在聚合过程中动态地创建 bucket。

NOTE: 单个响应中允许的 bucket 数量有最大限制，这个限制由于一个名为 `search.max_buckets` 的动态集群设置项控制。默认情况下，它是禁用状态（-1），但当尝试返回超过10,000 个（未来版本的默认值） bucket 的请求将产生一个弃用的警告日志。

include::bucket/adjacency-matrix-aggregation.asciidoc[]

include::bucket/children-aggregation.asciidoc[]

include::bucket/datehistogram-aggregation.asciidoc[]

include::bucket/daterange-aggregation.asciidoc[]

include::bucket/diversified-sampler-aggregation.asciidoc[]

include::bucket/filter-aggregation.asciidoc[]

include::bucket/filters-aggregation.asciidoc[]

include::bucket/geodistance-aggregation.asciidoc[]

include::bucket/geohashgrid-aggregation.asciidoc[]

include::bucket/global-aggregation.asciidoc[]

include::bucket/histogram-aggregation.asciidoc[]

include::bucket/iprange-aggregation.asciidoc[]

include::bucket/missing-aggregation.asciidoc[]

include::bucket/nested-aggregation.asciidoc[]

include::bucket/range-aggregation.asciidoc[]

include::bucket/reverse-nested-aggregation.asciidoc[]

include::bucket/sampler-aggregation.asciidoc[]

include::bucket/significantterms-aggregation.asciidoc[]

include::bucket/significanttext-aggregation.asciidoc[]

include::bucket/terms-aggregation.asciidoc[]

include::bucket/composite-aggregation.asciidoc[]

